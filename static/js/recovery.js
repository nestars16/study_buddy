(()=>{"use strict";var e={},t={};function n(o){var d=t[o];if(void 0!==d)return d.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}async function o(e,t){try{let n=await fetch("/save",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({document_id:e,text:t})});if(200!=n.status){open_external_error_modal(n,await n.text());return}}catch(e){open_external_error_modal(null,e)}}async function d(e){try{let t=await fetch(`/delete_document?document_id=${e}`,{method:"DELETE",credentials:"include"});if(200!=t.status){open_external_error_modal(t,await t.text());return}}catch(e){open_external_error_modal(null,e)}}n.rv=function(){return"1.0.0"},n.ruid="bundler=rspack@1.0.0";let r=null;async function a(e,t,n){r&&clearInterval(r);let{document_id:d,title:a}=n[e.target.id];document.getElementById("document-title").innerText=a;let c=document.getElementById("editor"),l=await t(d);c.value=l,document.getElementById("editor").dispatchEvent(new Event("input",{bubbles:!0})),document.getElementById("document-close-button").click(),r=setInterval(()=>{o(d,document.getElementById("editor").value)},6e4)}async function c(e,t,n){let{document_id:o}=n[e.target.parentElement.id];await t(o)}function l(e){e.disabled=!1,e.classList.remove("loading-button")}function i(e){e.classList.add("error-shake-modal")}async function m(){document.getElementById("email-submission").classList.add("hidden"),document.getElementById("sent").classList.remove("hidden"),await s()}async function s(){try{let e=await fetch("/send_recovery",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({email:document.getElementById("text-field").value})});200!=e.status&&console.log("Failed to send email")}catch(e){console.log(e)}}async function u(e,t,n){let o=document.getElementById("modal-error");if(t!==n){o.textContent="Passwords must exactly match",l(document.getElementById("recovery-submit-button")),i(document.getElementById("recovery-modal"));return}if(!t.match(/(?=.*[A-Za-z])(?=.*\d).{8,}$/)){o.textContent="Password must contain minimum eight characters\nat least one letter and one number",l(document.getElementById("recovery-submit-button")),i(document.getElementById("recovery-modal"));return}try{let n=await fetch("/try_recovery_code",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({code:e,password:t})});200!=n.status&&(o.textContent=await n.text(),l(document.getElementById("recovery-submit-button")),i(document.getElementById("recovery-modal")))}catch(e){o.textContent="There was an error trying to reset your password try again in a few moments",l(document.getElementById("recovery-submit-button")),i(document.getElementById("recovery-modal"))}}document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("submit-button"),t=document.getElementById("recovery-code"),n=document.getElementById("recovery-submit-button");e.onclick=async()=>{await m()},t.onclick=()=>{document.getElementById("email-submission").close(),document.getElementById("sent").close(),document.getElementById("recovery-modal").show()},n.onclick=async()=>{!function(e,t){let n;switch(void 0){case"light":n="black";break;case"dark":n="#FAFAFA"}e.style.borderTopColor=n,e.disabled=!0,e.classList.add("loading-button")}(n),document.getElementById("modal-error").textContent="";let e=document.getElementById("code-field").value,t=document.getElementById("password").value,o=document.getElementById("password-confirmation").value;if(!e||!t||!o){document.getElementById("modal-error").textContent="All fields are required to be filled",l(n),i(document.getElementById("recovery-modal"));return}await u(e,t,o)}})})();
//# sourceMappingURL=recovery.js.map